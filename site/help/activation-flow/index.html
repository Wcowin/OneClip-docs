
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OneClip - 简单专业的 macOS 剪贴板管理工具">
      
      
        <meta name="author" content="Wcowin">
      
      
        <link rel="canonical" href="https://wcowin.github.io/OneClip/help/activation-flow/">
      
      
        <link rel="prev" href="../faq/">
      
      
        <link rel="next" href="../../about/changelog/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="zensical-0.0.20">
    
    
      
        <title>激活码全流程 - OneClip文档</title>
      
    
    
      
        
      
      <link rel="stylesheet" href="../../assets/stylesheets/modern/main.d4922b3c.min.css">
      
        
          
        
        <link rel="stylesheet" href="../../assets/stylesheets/modern/palette.dfe2e883.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,500,500i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra2.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Wcowin/Wcowin.github.io@main/docs/stylesheets/ziti.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)),0),__md_get=(e,t=localStorage,a=__md_scope)=>JSON.parse(t.getItem(a.pathname+"."+e)),__md_set=(e,t,a=localStorage,_=__md_scope)=>{try{a.setItem(_.pathname+"."+e,JSON.stringify(t))}catch(e){}},document.documentElement.setAttribute("data-platform",navigator.platform)</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="OneClip文档" class="md-header__button md-logo" aria-label="OneClip文档" data-md-component="logo">
      
  <img src="https://picx.zhimg.com/80/v2-34b000e56d1af7ef61092dcd031dfd9a_1440w.webp?source=2c26e567" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-menu" viewBox="0 0 24 24"><path d="M4 5h16M4 12h16M4 19h16"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OneClip文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              激活码全流程
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="关闭自动模式"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="关闭自动模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-sun-moon" viewBox="0 0 24 24"><path d="M12 2v2M14.837 16.385a6 6 0 1 1-7.223-7.222c.624-.147.97.66.715 1.248a4 4 0 0 0 5.26 5.259c.589-.255 1.396.09 1.248.715M16 12a4 4 0 0 0-4-4M19 5l-1.256 1.256M20 12h2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="切换至夜间模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换至夜间模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="切换至日间模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换至日间模式" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-moon" viewBox="0 0 24 24"><path d="M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-search" viewBox="0 0 24 24"><path d="m21 21-4.34-4.34"/><circle cx="11" cy="11" r="8"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog" aria-label="查找">
  <button type="button" class="md-search__button">
    查找
  </button>
</div>
      
    
    <div class="md-header__source">
      
        <a href="https://github.com/Wcowin/OneClip" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-github" viewBox="0 0 24 24"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
  </div>
  <div class="md-source__repository">
    OneClip
  </div>
</a>
      
    </div>
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guide/installation/" class="md-tabs__link">
          
  
  快速开始

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../features/core-features/" class="md-tabs__link">
          
  
  功能介绍

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../purchase/" class="md-tabs__link">
          
  
  购买许可证

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  博客

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../faq/" class="md-tabs__link">
          
  
  常见问题

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../about/changelog/" class="md-tabs__link">
          
  
  关于

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OneClip文档" class="md-nav__button md-logo" aria-label="OneClip文档" data-md-component="logo">
      
  <img src="https://picx.zhimg.com/80/v2-34b000e56d1af7ef61092dcd031dfd9a_1440w.webp?source=2c26e567" alt="logo">

    </a>
    OneClip文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Wcowin/OneClip" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-github" viewBox="0 0 24 24"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
  </div>
  <div class="md-source__repository">
    OneClip
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    首页
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../guide/installation/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    快速开始
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../features/core-features/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    功能介绍
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../purchase/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    版本对比
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    博客首页
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    常见问题
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    常见问题
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    激活码全流程
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    激活码全流程
  

    
  </span>
  
  

      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        完整流程图
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        详细流程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="详细流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段一：用户购买与支付
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段一：用户购买与支付">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 创建订单
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 支付处理
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段二：支付完成后的处理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段二：支付完成后的处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 支付回调处理（关键步骤）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 跳转到订单完成页面
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段三：激活码查询与显示
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段三：激活码查询与显示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 订单完成页面加载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. 自动发送邮件（如果未发送）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. 手动重新发送邮件
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. 订单查询功能
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段四：应用内验证（服务器验证）
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段四：应用内验证（服务器验证）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. 应用内激活码验证（服务器验证）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. 应用端验证流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. 服务器端验证流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. 设备ID生成机制
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. 撤销检查机制
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        安全机制
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安全机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 订单查询安全
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 激活码验证安全
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 邮件发送安全
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        数据库表结构
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据库表结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-payment_orders" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. payment_orders 表（订单表）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-licenses" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. licenses 表（许可证表）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-device_activations" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. device_activations 表（设备激活表）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        时间处理统一
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="时间处理统一">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cstutc8" class="md-nav__link">
    <span class="md-ellipsis">
      
        统一使用北京时间（CST，UTC+8）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件发送流程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="邮件发送流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件发送时机
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件内容
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      
        关键API端点
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        验证检查清单
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="验证检查清单">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        激活码验证检查项
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        调试与排查
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调试与排查">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        常见问题
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
        总结
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      
        需要帮助？
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../about/changelog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    关于
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        完整流程图
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        详细流程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="详细流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段一：用户购买与支付
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段一：用户购买与支付">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 创建订单
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 支付处理
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段二：支付完成后的处理
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段二：支付完成后的处理">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 支付回调处理（关键步骤）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. 跳转到订单完成页面
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段三：激活码查询与显示
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段三：激活码查询与显示">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. 订单完成页面加载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. 自动发送邮件（如果未发送）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. 手动重新发送邮件
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. 订单查询功能
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        阶段四：应用内验证（服务器验证）
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="阶段四：应用内验证（服务器验证）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    <span class="md-ellipsis">
      
        9. 应用内激活码验证（服务器验证）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    <span class="md-ellipsis">
      
        10. 应用端验证流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      
        11. 服务器端验证流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        12. 设备ID生成机制
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      
        13. 撤销检查机制
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        安全机制
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="安全机制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 订单查询安全
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 激活码验证安全
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. 邮件发送安全
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        数据库表结构
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据库表结构">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-payment_orders" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. payment_orders 表（订单表）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-licenses" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. licenses 表（许可证表）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-device_activations" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. device_activations 表（设备激活表）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        时间处理统一
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="时间处理统一">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cstutc8" class="md-nav__link">
    <span class="md-ellipsis">
      
        统一使用北京时间（CST，UTC+8）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件发送流程
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="邮件发送流程">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件发送时机
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        邮件内容
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      
        关键API端点
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        验证检查清单
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="验证检查清单">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        激活码验证检查项
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        调试与排查
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="调试与排查">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        常见问题
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
        总结
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      
        需要帮助？
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  
  
  


<h1 id="_1">激活码全流程<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>本文档详细介绍 OneClip 激活码的完整流程。</p>
<h2 id="_2">完整流程图<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Text Only</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>用户购买 → 支付完成 → 生成激活码 → 发送邮件 → 用户查询 → 应用内验证
</code></pre></div></td></tr></table></div>
<h2 id="_3">详细流程<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">阶段一：用户购买与支付<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<h4 id="1">1. 创建订单<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>前端页面</strong>：购买页面（月度版/年度版/终身版）</li>
<li><strong>API接口</strong>：<code>POST /api/payment/create</code></li>
<li><strong>流程</strong>：</li>
<li>用户填写邮箱、选择套餐、设备数量</li>
<li>可选：输入优惠码</li>
<li>前端调用创建订单API</li>
<li>后端创建订单（状态：<code>pending</code>），返回订单ID和支付二维码</li>
<li>前端显示支付二维码，开始轮询支付状态</li>
</ul>
<h4 id="2">2. 支付处理<a class="headerlink" href="#2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>支付方式</strong>：易支付（支付宝/微信）</li>
<li><strong>轮询检测</strong>：前端每3秒查询一次订单状态</li>
<li><strong>API接口</strong>：<code>POST /api/payment/query-order</code></li>
<li><strong>支付回调</strong>：<code>POST /api/payment/notify</code>（易支付服务器主动通知）</li>
</ul>
<h3 id="_5">阶段二：支付完成后的处理<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<h4 id="3">3. 支付回调处理（关键步骤）<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>触发时机</strong>：易支付支付完成后，易支付服务器主动回调</li>
<li><strong>API接口</strong>：<code>POST /api/payment/notify</code></li>
<li><strong>处理流程</strong>：</li>
<li>✅ 验证签名、商户ID、支付状态</li>
<li>✅ 更新订单状态：<code>pending</code> → <code>paid</code></li>
<li>✅ 生成许可证和激活码：<ul>
<li>调用 <code>license_manager.generate_license_with_email()</code></li>
<li>生成格式：<code>XXXXX-XXXXX-XXXXX</code></li>
<li>生成许可证ID：<code>LIC-XXXXXXXX</code></li>
<li>计算有效期（月付/年付）</li>
</ul>
</li>
<li>✅ 更新订单：保存 <code>license_id</code> 和 <code>activation_code</code></li>
<li>✅ 发送激活码邮件：<ul>
<li>调用 <code>send_activation_email()</code></li>
<li>支持多邮件服务商自动切换（QQ邮箱、163邮箱等）</li>
</ul>
</li>
<li>✅ 更新 <code>email_sent = 1</code>（标记邮件已发送）</li>
</ul>
<h4 id="4">4. 跳转到订单完成页面<a class="headerlink" href="#4" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>跳转方式</strong>：</li>
<li><strong>前端轮询检测</strong>：检测到 <code>status === 'paid'</code> 后，2秒后跳转</li>
<li><strong>支付回调跳转</strong>：<code>/api/payment/return</code> 接口重定向</li>
<li><strong>目标页面</strong>：<code>/complete_order_page.html?order_id=xxx&amp;email=xxx</code></li>
</ul>
<h3 id="_6">阶段三：激活码查询与显示<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<h4 id="5">5. 订单完成页面加载<a class="headerlink" href="#5" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>API接口</strong>：<code>GET /api/order/complete?order_id=xxx&amp;email=xxx</code></li>
<li><strong>安全要求</strong>：必须同时提供订单号和邮箱，两者必须匹配</li>
<li><strong>返回数据</strong>：</li>
<li>订单信息（订单号、邮箱、套餐、设备上限等）</li>
<li>激活码（仅已支付订单返回）</li>
<li>许可证ID</li>
<li>有效期（月付/年付）</li>
<li>邮件发送状态（<code>email_sent</code>）</li>
</ul>
<h4 id="6">6. 自动发送邮件（如果未发送）<a class="headerlink" href="#6" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>触发时机</strong>：页面加载完成后，延迟3秒自动发送</li>
<li><strong>API接口</strong>：<code>POST /api/payment/send-email</code></li>
<li><strong>参数</strong>：</li>
<li><code>order_id</code>: 订单号</li>
<li><code>email</code>: 邮箱地址</li>
<li><code>choice</code>: <code>'send'</code>（自动发送）</li>
<li><strong>防重复机制</strong>：</li>
<li>检查 <code>email_sent</code> 标志</li>
<li>如果已发送，返回提示"邮件之前已经发送过了"</li>
<li>如果未发送，发送邮件并更新 <code>email_sent = 1</code></li>
</ul>
<h4 id="7">7. 手动重新发送邮件<a class="headerlink" href="#7" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>触发方式</strong>：用户点击"重新发送邮件"按钮</li>
<li><strong>API接口</strong>：<code>POST /api/payment/send-email</code></li>
<li><strong>参数</strong>：</li>
<li><code>order_id</code>: 订单号</li>
<li><code>email</code>: 邮箱地址</li>
<li><code>choice</code>: <code>'resend'</code>（允许重复发送）</li>
<li><strong>处理逻辑</strong>：</li>
<li><code>resend</code> 允许重复发送（不受 <code>email_sent</code> 限制）</li>
<li>发送成功后更新 <code>email_sent = 1</code></li>
</ul>
<h4 id="8">8. 订单查询功能<a class="headerlink" href="#8" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>位置</strong>：购买页面和管理后台</li>
<li><strong>API接口</strong>：<code>POST /api/payment/query-order</code></li>
<li><strong>安全要求</strong>：必须同时提供订单号和邮箱</li>
<li><strong>返回数据</strong>：</li>
<li>订单信息（脱敏处理）</li>
<li>激活码（仅已支付订单返回完整激活码）</li>
<li>订单状态</li>
</ul>
<h3 id="_7">阶段四：应用内验证（服务器验证）<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<h4 id="9">9. 应用内激活码验证（服务器验证）<a class="headerlink" href="#9" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>验证方式</strong>：✅ <strong>服务器验证</strong>（非本地验证）</li>
<li><strong>API接口</strong>：<code>POST https://oneclip.cloud/api/verify-license-3</code></li>
<li><strong>实现位置</strong>：</li>
<li>应用端：<code>OneClip/Services/LicenseServerService.swift</code></li>
<li>服务端：<code>license_api_server.py</code> 的 <code>/api/verify-license-3</code> 路由</li>
<li><strong>安全要求</strong>：</li>
<li>✅ 需要API密钥（<code>X-API-Key</code> header）</li>
<li>✅ 必须提供激活码、邮箱、设备ID</li>
<li>✅ 设备ID基于硬件UUID生成，确保唯一性和稳定性</li>
</ul>
<h4 id="10">10. 应用端验证流程<a class="headerlink" href="#10" title="Permanent link">&para;</a></h4>
<p><strong>10.1 用户激活操作</strong>
- <strong>触发位置</strong>：设置页面 → 高级功能 → 激活码输入
- <strong>实现函数</strong>：<code>EntitlementService.activate(with:email:)</code>
- <strong>流程</strong>：
  1. ✅ 验证邮箱格式
  2. ✅ 验证激活码格式（<code>XXXXX-XXXXX-XXXXX</code>）
  3. ✅ 调用服务器验证
  4. ✅ 构建请求数据
  5. ✅ 发送POST请求到 <code>https://oneclip.cloud/api/verify-license-3</code>
  6. ✅ 保存激活信息到本地（钥匙串 + UserDefaults）
  7. ✅ 应用许可证状态（更新 <code>isPro</code>、<code>plan</code> 等）</p>
<p><strong>10.2 应用启动时验证</strong>
- <strong>触发时机</strong>：应用启动后延迟1.5秒
- <strong>实现函数</strong>：<code>EntitlementService.restoreActivationStateOnStartup()</code>
- <strong>流程</strong>：
  1. ✅ 从本地恢复激活状态（钥匙串 → SettingsManager → 缓存）
  2. ✅ 延迟1秒后异步验证服务器状态
  3. ✅ 验证状态一致性</p>
<p><strong>10.3 定期验证检查</strong>
- <strong>触发时机</strong>：
  - 应用进入前台时（最小间隔6小时）
  - 手动检查（最小间隔5分钟）
  - 启动时（如果网络可用）
- <strong>检查内容</strong>：
  1. ✅ 许可证过期检查（本地）
  2. ✅ 远程撤销状态检查（服务器）
  3. ✅ 时间完整性验证</p>
<h4 id="11">11. 服务器端验证流程<a class="headerlink" href="#11" title="Permanent link">&para;</a></h4>
<p><strong>11.1 接收验证请求</strong>
- <strong>API端点</strong>：<code>POST /api/verify-license-3</code>
- <strong>装饰器</strong>：<code>@require_api_key</code>（验证API密钥）
- <strong>接收参数</strong>：
  <div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JSON</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;XXXXX-XXXXX-XXXXX&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user@example.com&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;appVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.4.5&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;platform&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;macOS&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;device_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;MacBook Pro&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;device_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;abc123def4567890&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ip_address&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.100&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>11.2 验证检查项</strong>
1. ✅ <strong>验证激活码存在性</strong>：
   - 查询 <code>licenses</code> 表
   - 检查 <code>activation_code</code> 和 <code>status = 'active'</code>
2. ✅ <strong>验证邮箱匹配</strong>：
   - 检查激活码绑定的邮箱是否与用户输入的邮箱一致（不区分大小写）
3. ✅ <strong>验证有效期</strong>（统一使用北京时间）：
   - 月付/年付：检查 <code>valid_until</code> 是否过期
   - 终身版：<code>valid_until</code> 为 <code>NULL</code>，永久有效
4. ✅ <strong>验证设备数量限制</strong>：
   - 查询已激活设备数量（<code>device_activations</code> 表）
   - 检查是否超过 <code>device_limit</code>
5. ✅ <strong>设备激活处理</strong>：
   - <strong>新设备</strong>：插入 <code>device_activations</code> 记录，记录激活历史
   - <strong>已激活设备</strong>：更新 <code>last_seen_at</code>，记录心跳日志
   - <strong>被停用设备</strong>：返回错误</p>
<p><strong>11.3 返回验证结果</strong>
- <strong>成功响应</strong>（200）：
  <div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JSON</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;许可证验证成功&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SUCCESS&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;license&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;key&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;LIC-XXXXXXXX&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lifetime&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;expiresAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;isValid&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;licenseType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;lifetime&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;expiresAt&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-26T22:20:00+08:00&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
- <strong>失败响应</strong>（400）：
  <div class="language-json highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">JSON</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;错误信息&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;INVALID_LICENSE&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;isValid&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2026-01-26T22:20:00+08:00&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="12-id">12. 设备ID生成机制<a class="headerlink" href="#12-id" title="Permanent link">&para;</a></h4>
<p><strong>12.1 设备ID生成</strong>
- <strong>实现位置</strong>：<code>OneClip/Services/DeviceIdentifierManager.swift</code>
- <strong>生成方式</strong>：
  1. ✅ 优先使用硬件UUID（<code>kIOPlatformUUIDKey</code>）
  2. ✅ 对UUID进行SHA256哈希
  3. ✅ 取前16位作为设备ID
  4. ✅ 持久化保存到UserDefaults（首次生成后永不改变）
- <strong>降级方案</strong>：
  - 如果无法获取硬件UUID，使用系统标识符组合（Bundle ID + 主机名 + 用户名）
  - 同样进行SHA256哈希，确保稳定性</p>
<p><strong>12.2 设备ID用途</strong>
- ✅ 设备唯一标识（防止跨设备复制激活码）
- ✅ 设备数量限制检查
- ✅ 设备管理（停用/恢复设备）
- ✅ 设备激活历史记录</p>
<h4 id="13">13. 撤销检查机制<a class="headerlink" href="#13" title="Permanent link">&para;</a></h4>
<p><strong>13.1 撤销检查端点</strong>
- <strong>API端点</strong>：<code>POST /api/check-revoke-status</code>
- <strong>检查频率</strong>：
  - 终身版：每天检查一次
  - 其他计划：每12小时检查一次
  - 应用进入前台：最小间隔6小时
  - 手动检查：最小间隔5分钟</p>
<p><strong>13.2 撤销策略</strong>
- <strong>宽限期</strong>：2小时
- <strong>确认阈值</strong>：至少2次确认才降级
- <strong>前台检查间隔</strong>：最小15分钟
- <strong>处理流程</strong>：
  1. 检测到撤销 → 进入宽限期
  2. 宽限期内继续检查
  3. 达到确认阈值或宽限期过期 → 降级为免费版</p>
<h2 id="_8">安全机制<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="1_1">1. 订单查询安全<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ 必须同时提供订单号和邮箱（AND条件）</li>
<li>✅ 频率限制：防止暴力枚举</li>
<li>✅ 模糊错误信息：不透露是订单号错误还是邮箱错误</li>
</ul>
<h3 id="2_1">2. 激活码验证安全<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ API密钥验证：<code>X-API-Key</code> header</li>
<li>✅ 邮箱+激活码双重验证</li>
<li>✅ 设备ID验证：防止未授权设备激活</li>
<li>✅ 设备数量限制：防止超量激活</li>
</ul>
<h3 id="3_1">3. 邮件发送安全<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h3>
<ul>
<li>✅ 防重复发送：自动发送时检查 <code>email_sent</code> 标志</li>
<li>✅ 允许手动重发：<code>resend</code> 允许用户主动重新发送</li>
</ul>
<h2 id="_9">数据库表结构<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h3 id="1-payment_orders">1. <code>payment_orders</code> 表（订单表）<a class="headerlink" href="#1-payment_orders" title="Permanent link">&para;</a></h3>
<ul>
<li><code>order_id</code>: 订单号</li>
<li><code>email</code>: 用户邮箱</li>
<li><code>plan</code>: 套餐类型（monthly/yearly/lifetime）</li>
<li><code>device_cap</code>: 设备上限</li>
<li><code>activation_code</code>: 激活码（支付后生成）</li>
<li><code>license_id</code>: 许可证ID（支付后生成）</li>
<li><code>status</code>: 订单状态（pending/paid/failed/cancelled）</li>
<li><code>email_sent</code>: 邮件发送标志（0/1）</li>
<li><code>created_at</code>: 创建时间</li>
<li><code>paid_at</code>: 支付时间</li>
</ul>
<h3 id="2-licenses">2. <code>licenses</code> 表（许可证表）<a class="headerlink" href="#2-licenses" title="Permanent link">&para;</a></h3>
<ul>
<li><code>license_id</code>: 许可证ID（LIC-XXXXXXXX）</li>
<li><code>activation_code</code>: 激活码（XXXXX-XXXXX-XXXXX）</li>
<li><code>email</code>: 绑定邮箱</li>
<li><code>plan</code>: 套餐类型</li>
<li><code>device_limit</code>: 设备数量限制</li>
<li><code>valid_until</code>: 过期时间（UTC时间，终身版为NULL）</li>
<li><code>status</code>: 状态（active/suspended/revoked）</li>
<li><code>issued_at</code>: 发放时间</li>
</ul>
<h3 id="3-device_activations">3. <code>device_activations</code> 表（设备激活表）<a class="headerlink" href="#3-device_activations" title="Permanent link">&para;</a></h3>
<ul>
<li><code>license_id</code>: 许可证ID</li>
<li><code>device_id</code>: 设备唯一标识（基于硬件UUID）</li>
<li><code>device_name</code>: 设备名称</li>
<li><code>is_active</code>: 是否激活（1/0）</li>
<li><code>last_seen_at</code>: 最后在线时间</li>
<li><code>activated_at</code>: 激活时间</li>
</ul>
<h2 id="_10">时间处理统一<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="cstutc8">统一使用北京时间（CST，UTC+8）<a class="headerlink" href="#cstutc8" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>数据库存储</strong>：UTC时间（标准做法）</li>
<li><strong>业务逻辑比较</strong>：统一转换为北京时间进行比较</li>
<li><strong>前端显示</strong>：统一格式化为北京时间字符串</li>
<li><strong>工具函数</strong>：</li>
<li><code>get_beijing_time()</code>: 获取当前北京时间</li>
<li><code>utc_to_beijing()</code>: UTC转北京时间</li>
<li><code>beijing_to_utc()</code>: 北京时间转UTC（存储）</li>
<li><code>format_beijing_time()</code>: 格式化显示</li>
</ol>
<h2 id="_11">邮件发送流程<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<h3 id="_12">邮件发送时机<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>自动发送</strong>（支付回调后）：</li>
<li>易支付支付回调成功后立即发送</li>
<li>
<p>更新 <code>email_sent = 1</code></p>
</li>
<li>
<p><strong>页面加载后自动发送</strong>（如果未发送）：</p>
</li>
<li>订单完成页面加载后，延迟3秒自动发送</li>
<li>
<p>检查 <code>email_sent</code> 标志，避免重复发送</p>
</li>
<li>
<p><strong>手动重新发送</strong>：</p>
</li>
<li>用户点击"重新发送邮件"按钮</li>
<li><code>choice: 'resend'</code>，允许重复发送</li>
</ol>
<h3 id="_13">邮件内容<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<ul>
<li>收件人：用户邮箱</li>
<li>发件人：vip@oneclip.cloud</li>
<li>主题：OneClip License Activation Code - {套餐类型}</li>
<li>内容：</li>
<li>购买信息（套餐、设备上限、订单号等）</li>
<li>激活码（高亮显示）</li>
<li>激活步骤说明</li>
</ul>
<h2 id="api">关键API端点<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>API端点</th>
<th>方法</th>
<th>用途</th>
<th>安全要求</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/payment/create</code></td>
<td>POST</td>
<td>创建订单</td>
<td>无</td>
</tr>
<tr>
<td><code>/api/payment/notify</code></td>
<td>POST</td>
<td>支付回调</td>
<td>易支付签名验证</td>
</tr>
<tr>
<td><code>/api/payment/query-order</code></td>
<td>POST</td>
<td>查询订单</td>
<td>订单号+邮箱</td>
</tr>
<tr>
<td><code>/api/payment/send-email</code></td>
<td>POST</td>
<td>发送邮件</td>
<td>订单号+邮箱</td>
</tr>
<tr>
<td><code>/api/order/complete</code></td>
<td>GET</td>
<td>订单完成页</td>
<td>订单号+邮箱</td>
</tr>
<tr>
<td><code>/api/verify-license-3</code></td>
<td>POST</td>
<td>验证激活码</td>
<td>API密钥+激活码+邮箱+设备ID</td>
</tr>
</tbody>
</table>
<h2 id="_14">验证检查清单<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="_15">激活码验证检查项<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<ol>
<li>✅ 激活码是否存在</li>
<li>✅ 激活码状态是否为 <code>active</code></li>
<li>✅ 邮箱是否匹配</li>
<li>✅ 有效期是否过期（月付/年付）</li>
<li>✅ 设备数量是否超限</li>
<li>✅ 设备是否被停用</li>
</ol>
<h2 id="_16">调试与排查<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h2>
<h3 id="_17">常见问题<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>邮件发送失败</strong>：</li>
<li>检查邮件服务商配置</li>
<li>查看服务器日志</li>
<li>
<p>检查 <code>email_sent</code> 状态</p>
</li>
<li>
<p><strong>激活码验证失败</strong>：</p>
</li>
<li>检查激活码格式</li>
<li>检查邮箱是否匹配</li>
<li>检查设备数量限制</li>
<li>
<p>检查有效期</p>
</li>
<li>
<p><strong>订单查询失败</strong>：</p>
</li>
<li>检查订单号和邮箱是否匹配</li>
<li>检查订单状态是否为 <code>paid</code></li>
<li>检查频率限制</li>
</ol>
<h2 id="_18">总结<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h2>
<p>整个流程从用户购买到应用内验证，涉及：
- <strong>4个主要阶段</strong>：购买支付、支付回调、激活码查询、应用验证
- <strong>6个关键API</strong>：创建订单、支付回调、查询订单、发送邮件、订单完成、验证激活码
- <strong>3个安全机制</strong>：订单查询安全、激活码验证安全、邮件发送安全
- <strong>统一时间处理</strong>：所有时间统一使用北京时间（CST，UTC+8）</p>
<p>流程设计合理，安全机制完善，用户体验良好。</p>
<h2 id="_19">需要帮助？<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<p>激活过程中遇到问题？联系我们：</p>
<ul>
<li><strong>📧 邮件</strong>：<a href="mailto:vip@oneclip.cloud">vip@oneclip.cloud</a></li>
<li><strong>💬 QQ 群</strong>：<a href="https://qm.qq.com/q/ckSQ6MXgLm">1060157293</a></li>
<li><strong>🌐 官网</strong>：<a href="https://oneclip.cloud">https://oneclip.cloud</a></li>
</ul>
















                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-circle-arrow-up" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="m16 12-4-4-4 4M12 16V8"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <!--
  Copyright (c) 2016-2025 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Footer -->
<footer class="md-footer">

  <!-- Link to previous and/or next page -->
  
    
      
      <nav
        class="md-footer__inner md-grid"
        aria-label="页脚"
        
      >

        <!-- Link to previous page -->
        
          
          <a
            href="../faq/"
            class="md-footer__link md-footer__link--prev"
            aria-label="上一页: FAQ"
          >
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-arrow-left" viewBox="0 0 24 24"><path d="m12 19-7-7 7-7M19 12H5"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                FAQ
              </div>
            </div>
          </a>
        

        <!-- Link to next page -->
        
          
          <a
            href="../../about/changelog/"
            class="md-footer__link md-footer__link--next"
            aria-label="下一页: 更新日志"
          >
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                更新日志
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="lucide lucide-arrow-right" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
            </div>
          </a>
        
      </nav>
    
  

  <!-- Further information -->
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Wcowin
    </div>
  
  
    Made with
    <a href="https://zensical.org/" target="_blank" rel="noopener">
      Zensical
    </a>
  
</div>

      <!-- Site Visits 访客统计 -->
      <style>
      .site-visit-count {
        padding: 0 12px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0.85rem;
        color: var(--md-footer-fg-color--light);
      }
      </style>
      <script async src="//finicounter.eu.org/finicounter.js"></script>
      <div class="site-visit-count">
        <span>本站访问量：</span><span id="finicount_views"></span>
      </div>

      <!-- Social links -->
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/Wcowin/OneClip" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:vip@oneclip.cloud" target="_blank" rel="noopener" title="邮件联系" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M61.4 64C27.5 64 0 91.5 0 125.4c0 .9 0 1.7.1 2.6H0v256c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V128h-.1c0-.9.1-1.7.1-2.6 0-33.9-27.5-61.4-61.4-61.4zM464 192.3V384c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192.3l154.8 117.4c31.4 23.9 74.9 23.9 106.4 0zM48 125.4c0-7.4 6-13.4 13.4-13.4h389.2c7.4 0 13.4 6 13.4 13.4 0 4.2-2 8.2-5.3 10.7L280.2 271.5c-14.3 10.8-34.1 10.8-48.4 0L53.3 136.1c-3.3-2.5-5.3-6.5-5.3-10.7"/></svg>
    </a>
  
    
    
    
    
    <a href="https://oneclip.cloud" target="_blank" rel="noopener" title="官方网站" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://qm.qq.com/q/ckSQ6MXgLm" target="_blank" rel="noopener" title="QQ群" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M434.1 420.4c-11.5 1.4-44.9-52.7-44.9-52.7 0 31.3-16.1 72.2-51 101.8 16.8 5.2 54.8 19.2 45.8 34.4-7.3 12.3-125.5 7.9-159.6 4-34.1 3.8-152.3 8.3-159.6-4-9-15.2 28.9-29.2 45.8-34.4-34.9-29.5-51.1-70.4-51.1-101.8 0 0-33.3 54.1-44.9 52.7-5.4-.6-12.4-29.6 9.3-99.7 10.3-33 22-60.5 40.1-105.8C60.9 98 109.2-.1 224.3-.1 338-.1 387.5 96 384.6 214.9c18.1 45.2 29.9 72.9 40.1 105.8 21.8 70.1 14.7 99.1 9.3 99.7z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://oneclip.cloud/wechat" target="_blank" rel="noopener" title="微信公众号" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154m-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4m-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2M563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4m-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6m107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      
      <script id="__config" type="application/json">{"annotate":null,"base":"../..","features":["announce.dismiss","navigation.prune","navigation.tracking","navigation.tabs","navigation.sections","navigation.top","navigation.footer","navigation.instant","navigation.instant.progress","navigation.expand","navigation.indexes","search.suggest","search.highlight","search.share","toc.follow","content.tabs.link","content.tooltips","content.code.copy","content.code.select","content.code.annotate","blog.index","blog.tags"],"search":"../../assets/javascripts/workers/search.e2d2d235.min.js","tags":null,"translations":{"clipboard.copied":"已复制","clipboard.copy":"复制","search.result.more.one":"在该页上还有 1 个符合条件的结果","search.result.more.other":"在该页上还有 # 个符合条件的结果","search.result.none":"没有找到符合条件的结果","search.result.one":"找到 1 个符合条件的结果","search.result.other":"# 个符合条件的结果","search.result.placeholder":"键入以开始搜索","search.result.term.missing":"缺少","select.version":"选择当前版本"},"version":null}</script>
    
    
      <script src="../../assets/javascripts/bundle.8ffeb9c9.min.js"></script>
      
    
  </body>
</html>